<div class="flex-panel" *ngIf="!isAppLoading && !project">
  <div class="flex-panel__header">
    <h2 class="title">No Project Selected</h2>
  </div>
</div>

<div class="flex-panel" *ngIf="isAppLoading">
  <div class="flex-panel__header">
    <h2 class="title">Loading project details...</h2>
  </div>
</div>

<div class="flex-panel" *ngIf="project">
  <div class="flex-panel__header" style="height: auto;">
    <h3>
      FOM: #{{project.id}} &nbsp; {{project.name}}<br>
    </h3>
  </div>

  <div class="flex-panel__scroll">
    <div class="app-detail-info">
      <section>
        <h3>Description</h3>
        <ul class="meta-container">
          <li>
            <span>{{project.description}}</span>
          </li>
        </ul>
        <br/>

        <h3>Geographic Shape Information 
          <span>({{projectSpatialDetail.length > 1 ? projectSpatialDetail.length + " Shapes": projectSpatialDetail.length + " Shape"}})</span>
        </h3>

        <app-details-map
          [projectSpatialDetail]="projectSpatialDetail">
        </app-details-map>

        <app-shape-info
          [spatialDetail]="projectSpatialDetail">
        </app-shape-info>
      </section>
      
      <section>
        <h3>FOM Details</h3>
        <ul class="meta-container">
          <li>
            FOM Holder:&nbsp;&nbsp;{{project.forestClient.name | titlecase}}
          </li>
          <li>
            <strong>FSP ID:&nbsp;&nbsp;{{project.fspId}}</strong>
          </li>
        </ul>
        <br/>
        <div>
          <div class="status"
            [ngClass]="{
              'commenting-open': project.workflowState.code === workflowStatus['COMMENT_OPEN'].code,
              'commenting-closed': project.workflowState.code === workflowStatus['COMMENT_CLOSED'].code,
              'finalized': project.workflowState.code === workflowStatus['FINALIZED'].code,
              'expired': project.workflowState.code === workflowStatus['EXPIRED'].code
            }">
            <div>
              <strong>
                Status: {{project.workflowState.description | titlecase}}
                {{
                  (project.workflowState.code === workflowStatus['FINALIZED'].code ||
                  project.workflowState.code === workflowStatus['EXPIRED'].code) ?
                  ', Commenting Closed': ''
                }}
              </strong>
            </div>
          </div>

          <div>
            <div class="status-msg" *ngIf="project.workflowState.code === workflowStatus['COMMENT_OPEN'].code">
              This project is currently accepting comments until {{project.commentingClosedDate | date:'longDate'}}.
            </div>
            <div class="status-msg" *ngIf="project.workflowState.code === workflowStatus['COMMENT_CLOSED'].code">
              Commenting is closed for this project on {{project.commentingClosedDate | date:'longDate'}}.
            </div>
            <button class="submit-comment-btn btn btn-primary" 
                    (click)="addComment()" 
                    *ngIf="project.workflowState.code === workflowStatus['COMMENT_OPEN'].code">
                    Submit a Comment</button>
          </div>
        </div>
      </section>
      <section *ngIf="attachments.length > 0">
        <h3>Attachments</h3>
        <div class="doc-list" style="width: 25rem;">
          <a class="doc-list__item"
            *ngFor="let attachment of attachments"
            [href]="configService.getAttachmentUrl(attachment.id)" 
            [title]="attachment.fileName || ''" 
            target="_blank" rel="noopener">
            <div class="cell doc-list__item-icon">
              <em class="material-icons">
                <!-- insert_drive_file -->
              </em>
            </div>
            <div class="cell doc-list__item-name">{{attachment.fileName}}</div>
            <div style="text-align: right;margin-right: 5px;">({{attachment.attachmentType.description}})</div>
          </a>
        </div>
      </section>
    </div>
  </div>
</div>
